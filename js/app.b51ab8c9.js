(function(){"use strict";var e={2830:function(e,s,t){var r=t(9242),n=t(3396);function a(e,s,t,r,a,o){const u=(0,n.up)("router-view");return(0,n.wg)(),(0,n.j4)(u)}var o={mounted(){console.log("/messPrev/")}},u=t(89);const i=(0,u.Z)(o,[["render",a]]);var g=i,c=t(2483);const l={class:"main"},d=(0,n._)("div",{class:"chat-header"},[(0,n._)("h3",null,"Friend")],-1),m={class:"chat-footer"};function p(e,s,t,r,a,o){const u=(0,n.up)("loader-spin"),i=(0,n.up)("observer-intersection"),g=(0,n.up)("error-load"),c=(0,n.up)("message-list"),p=(0,n.up)("message-textarea"),v=(0,n.up)("send-message-button"),f=(0,n.up)("container");return(0,n.wg)(),(0,n.iD)("div",l,[(0,n.Wm)(f,{class:"chat"},{default:(0,n.w5)((()=>[d,(0,n.Wm)(c,{messages:e.getMessages},{default:(0,n.w5)((()=>[(0,n.Wm)(i,{action:"messageModule/getMessages"},{default:(0,n.w5)((()=>[(0,n.Wm)(u)])),_:1}),(0,n.Wm)(g)])),_:1},8,["messages"]),(0,n._)("div",m,[(0,n.Wm)(p,{"model-value":e.newMessage,"onUpdate:modelValue":e.setNewMessage},null,8,["model-value","onUpdate:modelValue"]),(0,n.Wm)(v)])])),_:1})])}var v=t(65),f={computed:{...(0,v.rn)({newMessage:e=>e.messageModule.newMessage}),...(0,v.Se)({getUsers:"usersModule/getUsers",getMessages:"messageModule/getMessages"})},methods:{...(0,v.OI)({setNewMessage:"messageModule/setNewMessage"})}};const M=(0,u.Z)(f,[["render",p]]);var w=M;const h=[{path:"/",name:"Main",component:w}],y=(0,c.p7)({history:(0,c.PO)("/messPrev/"),routes:h});var _=y,b=t(4161);class k{static async loadMoreMessage(e){return b.Z.get("https://numia.ru/api/getMessages",{params:{offset:e},headers:{"Content-Type":"application/json"}})}}var x={state:()=>({messages:[],errorMessage:"",newMessage:""}),mutations:{setMessages(e,s){e.messages=[...e.messages,...s]},setErrorMessage(e,s){e.errorMessage=s},setNewMessage(e,s){e.newMessage=s},unshiftNewMessage(e,s){e.messages.unshift(s)}},getters:{getMessages(e){return e.messages},getErrorMessage(e){return e.errorMessage},getNewMessage(e){return e.newMessage}},actions:{async getMessages({commit:e,getters:s}){const t=await k.loadMoreMessage(s.getMessages.length);if(t.data.result){const s=t.data.result.map((e=>({textMessage:e,autor:Math.random()<.5?"your":"friend"})));e("setMessages",s),e("setErrorMessage",""),0===s.length&&e("setErrorMessage","Больше сообщений нет!")}else e("setErrorMessage",t.data)},async sendMessage({commit:e,getters:s}){if(s.getNewMessage){const t={textMessage:s.getNewMessage,autor:"your"};e("unshiftNewMessage",t),e("setNewMessage","")}}},namespaced:!0},O=(0,v.MT)({state:{},getters:{},mutations:{},actions:{},modules:{messageModule:x}});function j(e,s,t,r,a,o){const u=(0,n.up)("user-item");return(0,n.wg)(),(0,n.iD)("div",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.users,(e=>((0,n.wg)(),(0,n.j4)(u,{key:e.id,user:e},null,8,["user"])))),128))])}var I={props:{users:{type:Array,required:!0}},name:"users-list"};const D=(0,u.Z)(I,[["render",j]]);var Z=D,E=t(7139);const W={class:"user"};function N(e,s,t,r,a,o){return(0,n.wg)(),(0,n.iD)("div",W,[(0,n._)("h4",null,(0,E.zw)(t.user.name),1)])}var C={props:{user:{type:Object,required:!0}},name:"user-item"};const $=(0,u.Z)(C,[["render",N],["__scopeId","data-v-2775eda1"]]);var q=$;const P={class:"messages"};function S(e,s,t,a,o,u){const i=(0,n.up)("message-item");return(0,n.wg)(),(0,n.iD)("div",P,[(0,n.Wm)(r.W3,{name:"massages-list"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.messages,(e=>((0,n.wg)(),(0,n.j4)(i,{message:e,key:e},null,8,["message"])))),128))])),_:1}),(0,n.WI)(e.$slots,"default",{},void 0,!0)])}var T={props:{messages:{type:Array}},name:"message-list"};const V=(0,u.Z)(T,[["render",S],["__scopeId","data-v-36a8c835"]]);var U=V;function z(e,s,t,r,a,o){return(0,n.wg)(),(0,n.iD)("div",{class:(0,E.C_)(["message",{your:"your"==t.message.autor}])},[(0,n._)("p",null,(0,E.zw)(t.message.textMessage),1)],2)}var A={props:{message:{type:String,required:!0}},name:"message-item"};const B=(0,u.Z)(A,[["render",z]]);var F=B;const H=["value"];function K(e,s,t,r,a,o){return(0,n.wg)(),(0,n.iD)("textarea",{type:"text",rows:"3",value:t.modelValue,onInput:s[0]||(s[0]=(...e)=>o.updateInput&&o.updateInput(...e)),placeholder:"Введите текст"},null,40,H)}var Y={name:"message-textarea",props:{modelValue:{type:String,required:!0}},methods:{updateInput(e){this.$emit("update:modelValue",e.target.value)}}};const L=(0,u.Z)(Y,[["render",K],["__scopeId","data-v-12ae9996"]]);var G=L;const J={class:"loader"};function Q(e,s,t,r,a,o){return(0,n.wg)(),(0,n.iD)("div",J)}var R={name:"loader-spin"};const X=(0,u.Z)(R,[["render",Q],["__scopeId","data-v-02742432"]]);var ee=X;const se=e=>((0,n.dD)("data-v-4b940f3a"),e=e(),(0,n.Cn)(),e),te=se((()=>(0,n._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[(0,n._)("polyline",{points:"1 4 1 10 7 10"}),(0,n._)("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})],-1)));function re(e,s,t,a,o,u){return(0,n.wg)(),(0,n.j4)(r.uT,{name:"error-load"},{default:(0,n.w5)((()=>[e.getErrorMessage?((0,n.wg)(),(0,n.iD)("div",{key:0,class:"error",onClick:s[0]||(s[0]=e=>this.$store.dispatch("messageModule/getMessages"))},[(0,n._)("h2",null,(0,E.zw)(e.getErrorMessage),1),te])):(0,n.kq)("",!0)])),_:1})}var ne={computed:{...(0,v.Se)({getErrorMessage:"messageModule/getErrorMessage"})},name:"error-load"};const ae=(0,u.Z)(ne,[["render",re],["__scopeId","data-v-4b940f3a"]]);var oe=ae;const ue=(0,n._)("svg",{width:"24",height:"24",viewBox:"0 0 24 20",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[(0,n._)("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),(0,n._)("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})],-1),ie=[ue];function ge(e,s,t,r,a,o){return(0,n.wg)(),(0,n.iD)("div",{onClick:s[0]||(s[0]=e=>this.$store.dispatch("messageModule/sendMessage"))},ie)}var ce={name:"send-message-button"};const le=(0,u.Z)(ce,[["render",ge]]);var de=le;const me={class:"observer",ref:"observer"};function pe(e,s,t,r,a,o){return(0,n.wg)(),(0,n.iD)("div",me,[(0,n.WI)(e.$slots,"default")],512)}var ve={name:"observer-intersection",props:{action:{type:String}},mounted(){const e={rootMargin:"0px",threshold:1},s=e=>{e[0].isIntersecting&&this.$store.dispatch(this.action)},t=new IntersectionObserver(s,e);t.observe(this.$refs.observer)}};const fe=(0,u.Z)(ve,[["render",pe]]);var Me=fe,we=[Z,q,U,F,ee,oe,G,de,Me];const he=(0,r.ri)(g);we.forEach((e=>he.component(e.name,e))),he.use(O).use(_).mount("#app")}},s={};function t(r){var n=s[r];if(void 0!==n)return n.exports;var a=s[r]={exports:{}};return e[r].call(a.exports,a,a.exports,t),a.exports}t.m=e,function(){var e=[];t.O=function(s,r,n,a){if(!r){var o=1/0;for(c=0;c<e.length;c++){r=e[c][0],n=e[c][1],a=e[c][2];for(var u=!0,i=0;i<r.length;i++)(!1&a||o>=a)&&Object.keys(t.O).every((function(e){return t.O[e](r[i])}))?r.splice(i--,1):(u=!1,a<o&&(o=a));if(u){e.splice(c--,1);var g=n();void 0!==g&&(s=g)}}return s}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[r,n,a]}}(),function(){t.n=function(e){var s=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(s,{a:s}),s}}(),function(){t.d=function(e,s){for(var r in s)t.o(s,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:s[r]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)}}(),function(){var e={143:0};t.O.j=function(s){return 0===e[s]};var s=function(s,r){var n,a,o=r[0],u=r[1],i=r[2],g=0;if(o.some((function(s){return 0!==e[s]}))){for(n in u)t.o(u,n)&&(t.m[n]=u[n]);if(i)var c=i(t)}for(s&&s(r);g<o.length;g++)a=o[g],t.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return t.O(c)},r=self["webpackChunkmessager"]=self["webpackChunkmessager"]||[];r.forEach(s.bind(null,0)),r.push=s.bind(null,r.push.bind(r))}();var r=t.O(void 0,[998],(function(){return t(2830)}));r=t.O(r)})();
//# sourceMappingURL=app.b51ab8c9.js.map